# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∏–º–ø–æ—Ä—Ç—ã
**–§–∞–π–ª:** `handlers/customer/profile.py`

–î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã:
- `main_menu_customer`
- `main_menu_seller`

–≠—Ç–æ –±—ã–ª–∞ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏ "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞" - –∫–æ–≥–¥–∞ –∫–æ–¥ –ø—ã—Ç–∞–ª—Å—è –≤—ã–∑–≤–∞—Ç—å —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏, –≤–æ–∑–Ω–∏–∫–∞–ª `NameError`.

### 2. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

#### –í —Ñ—É–Ω–∫—Ü–∏–∏ `switch_to_seller_cb`:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `callback.message` –Ω–∞ `None`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ:
  - –ü–æ–ø—ã—Ç–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –Ø–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ë–î
  - –ù–∞–ª–∏—á–∏–µ –æ–¥–æ–±—Ä–µ–Ω–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
  - –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –Ω–∞ seller mode
  - –†–µ–∑—É–ª—å—Ç–∞—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–µ–∂–∏–º–∞
  - –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ–Ω—é
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω `getattr()` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞—Ç—Ä–∏–±—É—Ç—É `role`
- –†–∞–∑–¥–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –≤–º–µ—Å—Ç–æ –æ–±—â–µ–≥–æ "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞"

#### –í —Ñ—É–Ω–∫—Ü–∏–∏ `switch_to_customer_cb`:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `callback.message` –Ω–∞ `None`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

### 3. –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–¢–µ–ø–µ—Ä—å –≤ –ª–æ–≥–∞—Ö –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ:
```
üîÑ User 123456789 attempting to switch to seller mode
User 123456789 language: ru
User 123456789 role from DB: seller
User 123456789 has approved store: True
‚úÖ User 123456789 switched to seller mode
```

–ò–ª–∏ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏:
```
‚ùå User 123456789 denied switch to seller mode (role=customer, has_store=False)
```

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏. –í—ã —É–≤–∏–¥–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º —à–∞–≥–µ.

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ Telegram
1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞
2. –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ—Ñ–∏–ª—å"
3. –ï—Å–ª–∏ –≤—ã –ø—Ä–æ–¥–∞–≤–µ—Ü —Å –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–º –º–∞–≥–∞–∑–∏–Ω–æ–º, –≤—ã —É–≤–∏–¥–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üè™ –†–µ–∂–∏–º –ø–∞—Ä—Ç–Ω–µ—Ä–∞"
4. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É - –¥–æ–ª–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–∫–∏
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –º–µ–Ω—é –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –Ω–∞ –º–µ–Ω—é –ø–∞—Ä—Ç–Ω–µ—Ä–∞

### 3. –ß—Ç–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ë–î
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- `role = 'seller'` –≤ —Ç–∞–±–ª–∏—Ü–µ `users`
- –ï—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –º–∞–≥–∞–∑–∏–Ω —Å–æ `status = 'active'` –≤ —Ç–∞–±–ª–∏—Ü–µ `stores`

–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ PostgreSQL:
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT user_id, role FROM users WHERE user_id = YOUR_USER_ID;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
SELECT store_id, name, status FROM stores WHERE owner_id = YOUR_USER_ID;
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

### –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `test_profile_switch.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π.
–ó–∞–ø—É—Å–∫: `python test_profile_switch.py`

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –≤—Å–µ –µ—â–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞:
1. **–û—à–∏–±–∫–∞ –≤ `has_approved_store`**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–µ –∏–º–µ—Ç—å –æ–¥–æ–±—Ä–µ–Ω–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞
2. **–û—à–∏–±–∫–∞ –≤ `set_user_view_mode`**: –ø—Ä–æ–±–ª–µ–º–∞ —Å –∑–∞–ø–∏—Å—å—é –≤ –ë–î –∏–ª–∏ –∫–µ—à
3. **–û—à–∏–±–∫–∞ –≤ `callback.message.answer`**: –ø—Ä–æ–±–ª–µ–º–∞ —Å Telegram API

–í—Å–µ –æ—à–∏–±–∫–∏ —Ç–µ–ø–µ—Ä—å –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏, —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É.
